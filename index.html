<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>CRICKET YODDHA - Live Stream</title>
  
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@600;700;800&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <style>
    :root {
      --bg-dark: #000000;
      --gold-main: #FFD700;
      --gold-dark: #FFAA00;
      --text-white: #ffffff;
      --border-color: rgba(255, 255, 255, 0.1);
    }

    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; user-select: none; }
    
    body {
      margin: 0; padding: 0;
      background-color: var(--bg-dark);
      font-family: 'Poppins', sans-serif;
      color: var(--text-white);
      padding-bottom: 80px;
      overflow-x: hidden;
    }

    /* HEADER */
    header {
      position: fixed; top: 0; width: 100%; height: 65px;
      background: rgba(0, 0, 0, 0.95);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--border-color);
      display: flex; align-items: center; justify-content: space-between;
      padding: 0 20px; z-index: 1000;
    }

    .menu-icon { font-size: 28px; color: #fff; cursor: pointer; }
    .logo-container { position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); }
    .logo-img { height: 40px; filter: drop-shadow(0 0 5px rgba(255,215,0,0.5)); }

    .header-live {
      display: flex; align-items: center; gap: 5px;
      background: rgba(255,0,0,0.15); border: 1px solid rgba(255,0,0,0.4);
      padding: 4px 8px; border-radius: 4px;
    }
    .h-dot { width: 8px; height: 8px; background: red; border-radius: 50%; animation: blink 1s infinite; }
    .h-text { font-size: 12px; font-weight: 700; color: red; font-family: 'Rajdhani'; letter-spacing: 1px; }
    @keyframes blink { 50% { opacity: 0.4; } }

    /* VIDEO */
    .video-container {
      margin-top: 65px; width: 100%; aspect-ratio: 16/9;
      background: #000; border-bottom: 1px solid var(--border-color);
    }
    .video-container iframe { width: 100%; height: 100%; border: none; display: block; }

    /* TICKER */
    .ticker-wrap {
      background: var(--gold-main); height: 30px; overflow: hidden;
      display: flex; align-items: center; border-bottom: 1px solid #000;
    }
    .ticker-text {
      color: #000; font-weight: 800; font-family: 'Rajdhani'; font-size: 13px;
      white-space: nowrap; animation: scroll 20s linear infinite; padding-left: 100%;
    }
    @keyframes scroll { 100% { transform: translateX(-100%); } }

    /* MAIN ACTIONS */
    .action-section { padding: 25px 15px; background: #0a0a0a; }

    /* LIVE WATCHING CARD */
    .live-stats-card {
      background: #111;
      border: 1px solid var(--border-color);
      border-radius: 12px; padding: 15px;
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 25px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    }

    .live-left { display: flex; align-items: center; gap: 10px; }
    .live-icon-box {
      width: 40px; height: 40px; background: rgba(255,255,255,0.05);
      border-radius: 50%; display: flex; align-items: center; justify-content: center;
    }
    .live-icon-box i { color: var(--gold-main); font-size: 20px; }
    
    .live-info { display: flex; flex-direction: column; }
    .live-number { font-size: 20px; font-weight: 700; color: #fff; font-family: 'Rajdhani'; line-height: 1; }
    .live-label { font-size: 11px; color: #888; text-transform: uppercase; margin-top: 2px; }

    .live-badge-right {
      background: #ff0000; color: #fff;
      padding: 4px 8px; border-radius: 4px;
      font-size: 10px; font-weight: 800; letter-spacing: 0.5px;
      display: flex; align-items: center; gap: 4px;
      box-shadow: 0 0 10px rgba(255,0,0,0.4);
    }
    .live-badge-right .dot { width: 5px; height: 5px; background: #fff; border-radius: 50%; animation: blink 1s infinite; }

    /* BUTTONS */
    .btn-grid { display: grid; grid-template-columns: 1.5fr 1fr 1fr; gap: 10px; }

    .btn {
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      padding: 12px 5px; border-radius: 10px; text-decoration: none;
      transition: 0.2s; position: relative;
    }
    .btn:active { transform: scale(0.96); }

    .btn-gold {
      background: linear-gradient(135deg, var(--gold-main), var(--gold-dark));
      border: none; box-shadow: 0 4px 15px rgba(255, 215, 0, 0.2);
    }
    .btn-gold i { color: #000; font-size: 24px; margin-bottom: 2px; }
    .btn-gold span { color: #000; font-weight: 800; font-size: 12px; text-transform: uppercase; font-family: 'Rajdhani'; }

    .btn-dark {
      background: #1a1a1a; border: 1px solid var(--border-color);
    }
    .btn-dark i { color: #ccc; font-size: 20px; margin-bottom: 2px; }
    .btn-dark span { color: #ccc; font-size: 10px; font-weight: 600; text-transform: uppercase; }

    /* POPUP (No X, Clean) */
    .modal-overlay {
      position: fixed; inset: 0; background: rgba(0,0,0,0.9);
      z-index: 9999; display: flex; align-items: center; justify-content: center;
      opacity: 0; pointer-events: none; transition: 0.4s;
      backdrop-filter: blur(5px);
    }
    .modal-overlay.active { opacity: 1; pointer-events: auto; }

    .modal-box {
      width: 85%; max-width: 320px;
      background: #181818; border: 1px solid #333;
      border-radius: 20px; padding: 30px 20px; text-align: center;
      box-shadow: 0 10px 40px rgba(0,0,0,0.5);
      transform: translateY(20px); transition: 0.4s;
    }
    .modal-overlay.active .modal-box { transform: translateY(0); }

    .pop-title { color: var(--gold-main); font-size: 26px; font-weight: 800; margin: 0 0 10px; font-family: 'Poppins', sans-serif; }
    .pop-desc { color: #aaa; font-size: 14px; margin-bottom: 25px; line-height: 1.5; }

    .pop-btn {
      display: block; width: 100%; padding: 14px; border-radius: 50px;
      text-decoration: none; font-weight: 700; font-size: 16px; 
      margin-bottom: 12px; text-transform: capitalize; letter-spacing: 0.5px;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .pop-btn:active { transform: scale(0.95); }

    .pb-join { background: var(--gold-main); color: #000; box-shadow: 0 5px 15px rgba(255, 215, 0, 0.2); }
    .pb-close { background: #252525; color: #fff; border: 1px solid #333; cursor: pointer; }

    /* SIDEBAR */
    .sidebar {
      position: fixed; left: -100%; top: 0; width: 280px; height: 100%;
      background: #111; z-index: 5000; transition: 0.3s; border-right: 1px solid #222;
    }
    .sidebar.open { left: 0; }
    .sb-head { padding: 25px; color: var(--gold-main); font-size: 22px; font-weight: 700; border-bottom: 1px solid #222; font-family: 'Rajdhani'; }
    
    .sb-link {
      display: flex; align-items: center; gap: 15px; padding: 15px 25px;
      color: #ccc; text-decoration: none; font-size: 14px; border-bottom: 1px solid #1a1a1a;
    }
    .sb-link i { font-size: 20px; color: var(--gold-main); }
    .insta-link i { color: #E1306C; }

    .sb-stats { margin: 20px; padding: 15px; background: #1a1a1a; border-radius: 8px; margin-left: 15px; margin-right: 15px;}
    .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 4999; display: none; }
    .overlay.active { display: block; }

  </style>
</head>
<body>

  <!-- POPUP -->
  <div class="modal-overlay" id="popup">
    <div class="modal-box">
      <div class="pop-title">Support Us!</div>
      <div class="pop-desc">Join our Telegram for more link & update.</div>
      <a href="#" id="pop-link" class="pop-btn pb-join">Join Now</a>
      <button class="pop-btn pb-close" onclick="closePopup()">Already Joined</button>
    </div>
  </div>

  <!-- HEADER -->
  <header>
    <div class="menu-icon material-icons" onclick="toggleMenu()">menu</div>
    <div class="logo-container">
      <img src="https://i.ibb.co/HLkW7zJV/ei-1765534270242-removebg-preview.png" class="logo-img" alt="Logo">
    </div>
    <div class="header-live">
      <div class="h-dot"></div> <span class="h-text">LIVE</span>
    </div>
  </header>

  <!-- SIDEBAR -->
  <div class="sidebar" id="sidebar">
    <div class="sb-head">CRICKET YODDHA</div>
    <a href="#" id="side-tg" class="sb-link"><i class="material-icons">telegram</i> Join Telegram</a>
    <a href="https://www.instagram.com/cricket_yoddha?igsh=MWpoZDltdjZzYnRncw==" class="sb-link insta-link"><i class="material-icons">camera_alt</i> Contact Us (Insta)</a>
    <a href="javascript:location.reload()" class="sb-link"><i class="material-icons">refresh</i> Refresh Page</a>
    <div class="sb-stats">
      <div style="font-size:10px; color:#888; text-transform:uppercase;">Daily Visitors</div>
      <div style="font-size:20px; font-weight:700; color:#fff;" id="total-views-count">...</div>
    </div>
  </div>
  <div class="overlay" id="overlay" onclick="toggleMenu()"></div>

  <!-- VIDEO -->
  <div class="video-container">
    <iframe src="https://dillzycreations.github.io/Star-Sports-Hindi/" allowfullscreen allow="autoplay; encrypted-media" scrolling="no"></iframe>
  </div>

  <!-- TICKER -->
  <div class="ticker-wrap">
    <div class="ticker-text">
       EVERYONE MUST SHARE THE LINK üîó | JOIN TELEGRAM FOR BACKUP LINKS üì≤ | WATCH HD LIVE STREAMING WITHOUT BUFFERING üèèüî•
    </div>
  </div>

  <!-- ACTIONS -->
  <div class="action-section">
    
    <!-- LIVE WATCHING SECTION -->
    <div class="live-stats-card">
      <div class="live-left">
        <div class="live-icon-box"><i class="material-icons">visibility</i></div>
        <div class="live-info">
          <span class="live-number" id="live-viewer-count">0</span>
          <span class="live-label">Watching Now</span>
        </div>
      </div>
      <div class="live-badge-right">
        <div class="dot"></div> LIVE
      </div>
    </div>

    <!-- BUTTONS -->
    <div class="btn-grid">
      <a href="#" id="main-btn" class="btn btn-gold">
        <i class="material-icons">send</i>
        <span>Join Telegram</span>
      </a>
      <a href="javascript:void(0)" onclick="sharePage()" class="btn btn-dark">
        <i class="material-icons">share</i>
        <span>Share</span>
      </a>
      <a href="javascript:location.reload()" class="btn btn-dark">
        <i class="material-icons">refresh</i>
        <span>Refresh</span>
      </a>
    </div>
  </div>

  <!-- FIREBASE LOGIC -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

  <script>
    // ================= CONFIG =================
    const WEBSITE_ID = "channel_hindi"; // Change this for other pages (channel_2, etc.)
    const TELEGRAM_LINK = "https://t.me/+rwZKMV0-L8wyOTll";
    // ==========================================

    document.getElementById('pop-link').href = TELEGRAM_LINK;
    document.getElementById('side-tg').href = TELEGRAM_LINK;
    document.getElementById('main-btn').href = TELEGRAM_LINK;

    function toggleMenu() {
      document.getElementById('sidebar').classList.toggle('open');
      document.getElementById('overlay').classList.toggle('active');
    }

    // Popup Logic
    window.onload = () => {
      setTimeout(() => {
        if(!sessionStorage.getItem('pop_final_' + WEBSITE_ID)) {
          document.getElementById('popup').classList.add('active');
        }
      }, 3000);
    };

    function closePopup() {
      document.getElementById('popup').classList.remove('active');
      sessionStorage.setItem('pop_final_' + WEBSITE_ID, 'true');
    }

    async function sharePage() {
      if(navigator.share) await navigator.share({title:'Live Cricket', url: window.location.href});
      else prompt("Copy Link:", window.location.href);
    }

    // --- FIREBASE CONFIG ---
    const firebaseConfig = {
      apiKey: "AIzaSyA-vR50CMDYJVHApJir-6fmgRqhFiqQDU8",
      authDomain: "my-website-cricket.firebaseapp.com",
      databaseURL: "https://my-website-cricket-default-rtdb.firebaseio.com",
      projectId: "my-website-cricket",
      storageBucket: "my-website-cricket.appspot.com",
      messagingSenderId: "664276981494",
      appId: "1:664276981494:web:4d6b5cd5c55f6b6b18fed7"
    };

    if(!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // 1. REAL-TIME WATCHING LOGIC (Remove on Disconnect)
    const liveRef = db.ref('status_live/' + WEBSITE_ID);
    const connectedRef = db.ref('.info/connected');

    connectedRef.on('value', (snap) => {
      if (snap.val() === true) {
        // User connected: Create a reference
        const userRef = liveRef.push();
        
        // CRITICAL: Tells server to delete this reference if user disconnects (closes tab/browser)
        userRef.onDisconnect().remove();
        
        // Set value to confirm presence
        userRef.set({
            status: "online",
            joinedAt: firebase.database.ServerValue.TIMESTAMP
        });
      }
    });

    // Count live users
    liveRef.on('value', (snap) => {
      const count = snap.numChildren();
      document.getElementById('live-viewer-count').innerText = count;
    });

    // 2. DAILY VISITORS (Resets automatically by Date)
    const todayStr = new Date().toISOString().slice(0, 10); // YYYY-MM-DD
    const visitRef = db.ref('daily_stats/' + WEBSITE_ID + '/' + todayStr);
    const localKey = 'v_count_' + WEBSITE_ID + '_' + todayStr;

    // Increment only if new visitor for today
    if(!localStorage.getItem(localKey)) {
      visitRef.transaction(currentVisits => (currentVisits || 0) + 1);
      localStorage.setItem(localKey, 'true');
    }

    visitRef.on('value', (snap) => {
      document.getElementById('total-views-count').innerText = (snap.val() || 0).toLocaleString();
    });

  </script>
</body>
</html>
